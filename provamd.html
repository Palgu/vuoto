<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>VUOTO</title>

    <link rel="stylesheet" href="/css/styles.css">

    <!--
    http://www.showdownjs.com/
    -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/11.0.0/markdown-it.min.js"></script>
    <script type="text/javascript" src="./js/markdown-it-mark.min.js"></script>
    <script type="text/javascript" src="./js/markdown-it-ins.min.js"></script>
    <script type="text/javascript" src="./js/markdown-it-container.min.js"></script>
  </head>

  <body>

    <header>
      <h1>VUOTO</h1>
    </header>

    <nav>
      QUI POTREBBE ANDARCI L'INDICE
      <ul>
        <li>uno</li>
        <li>due</li>
        <li>tre</li>
      </ul>
    </nav>

    <section id="content">

    </section>

    <script type="text/javascript">

      var md = window.markdownit()
      .use(window.markdownitMark)
      .use(window.markdownitIns)
      .use(window.markdownitContainer, 'box', {

            validate: function(params) {
              //return params.trim().match(/^box\s+(.*)$/);
              return true;
            },

            render: function (tokens, idx) {
              var m = tokens[idx].info.trim().match(/^box\s+(.*)$/);

              if (tokens[idx].nesting === 1) {
                // opening tag
                return '<div class="inevidenza">';

              } else {
                // closing tag
                return '</div>\n';
              }
            }
          })

      var capitoli = [
        "01.chapter",
        "02.chapter",
        "03.chapter"
      ]

      console.log(capitoli)

      var elabora = function() {
        var html = md.render(this.responseText);
        document.querySelector("#content").innerHTML = html;
      }

      var elabora2 = function () {
        let div = document.createElement('div');
        div.classList.add("container");
        document.querySelector("#content").appendChild(div);
        let elabora = function() {
        var html = md.render(this.responseText);
        div.innerHTML = html;
        }
        return elabora;
      }

      var popola = function() {

        console.log("--- popola ---");
        var oReq = new XMLHttpRequest();
        oReq.addEventListener("load", elabora2());
        oReq.open("GET", "./chapters/01.chapter");
        oReq.send();

        console.log("--- popola ---");
        var oReq = new XMLHttpRequest();
        oReq.addEventListener("load", elabora2());
        oReq.open("GET", "./chapters/02.chapter");
        oReq.send();

        console.log("--- popola ---");
        var oReq = new XMLHttpRequest();
        oReq.addEventListener("load", elabora2());
        oReq.open("GET", "./chapters/03.chapter");
        oReq.send();

      }



      popola();

    </script>

  </body>
</html>
